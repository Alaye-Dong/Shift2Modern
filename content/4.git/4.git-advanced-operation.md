---
title: 进阶技巧（WIP）
description: Git 进阶技巧
---

# 进阶技巧（WIP）

## *Git* 分支

很多版本控制系统都有分支（*Branch*）这一概念，使用分支允许开发者在不影响开发主线的情况下，独立进行新功能的开发，经过测试后再将代码合并回主线上。

为何 *Git* 能从中众多版本控制工具中脱颖而出呢？答案正是因为 *Git* 的分支处理极其高效。与 *Git* 不同，多数版本控制系统需要创建一份完整的副本来实现分支，面对大型项目时会变得非常低效，而 *Git* 无论项目大小分支创建几乎在一瞬间就能完成，这使得在开发中频繁使用分支变得十分方便。

*Git* 分支的具体原理可以参考 [Pro Git Book](https://git-scm.com/book/zh/v2/Git-%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E7%AE%80%E4%BB%8B)，下面将简单解释其工作原理和常用操作。

### 分支的工作原理

可以将 Git 库看作一棵树，树的根节点是初始的提交对象，每个节点代表一个提交对象。当创建一个新的分支时，就相当于在当前节点上分叉出一条新的分支，这条分支指向一个新的节点。这两个分支共享相同的历史记录，但它们可以独立地进行修改，就像是在同一棵树上的不同枝干上生长的两个树枝一样。

每次提交代码时，就相当于在当前节点上添加一个新的子节点，新的节点会指向前一个节点，形成一条链式结构。当切换分支时，就相当于从当前节点上沿着某个分支走到另一条分支上的节点上，这个过程中 Git 会自动更新 HEAD 指针的位置，使其指向新的节点。就好像是从一棵树上的一个节点走到了另一棵树上的一个节点一样。

当需要将两个分支合并时，就相当于将两个节点的修改合并到一起，生成一个新的节点，并将当前分支指向新的节点。这个过程中 Git 会使用一些算法，如三方合并算法或递归合并算法，来自动合并两个节点的修改。就好像是~~将两棵树的树枝合并在一起，形成一棵更加繁茂的树一样。~~

总的来说，Git 中的分支就像一棵树，每个节点代表一个提交对象，每个分支指向一个节点，通过对节点的复制和指针的更新，实现了分支的创建、切换和合并等基本操作。而 Git 通过这样的树形结构，记录了代码的历史，方便进行版本控制和代码管理。

![Git 分支示意图](/img/4/4/Branch.png)
<!-- TODO: Add source here -->


### 创建分支 `git branch [branch_name]`

新分支的创建非常简单，只需要在 `git branch` 命令后面加上分支名即可。
:terminal{content="git branch [branch_name]"}

此命令会在当前分支的基础上新建一个名为 `[branch-name]` 的分支,新建的分支会指向当前分支的最新提交对象，也就是目前分支的最后一次提交。 :br
这使得新分支的历史记录和当前分支完全一致，就像在树枝分叉一样，分叉之前的部分是完全一致的。

::alert{type="info"}
`git branch` 命令也可以用来查看当前仓库中的分支，不加参数时会列出所有分支，当前分支会在前面加上一个星号 `*`。
::

### 切换分支 `git checkout` / `git switch`

新分支创建之后，*Git* 并不会自动切换到新分支上，需要手动切换到新分支上才能开始在新分支上进行开发。
:terminal{content="git checkout [branch-name]"}

此命令会将当前分支切换到 `[branch-name]` 分支，切换分支的过程中，*Git* 会自动更新 `HEAD` 指针的位置，使其指向新分支的最新提交对象。

![](/img/4/4/git-switch-branch.gif)

::alert{type="info"}
在 *Git 2.23* 版本之后，可以使用 `git switch` 命令来切换分支，使用方法与 `git checkout` 命令相同，但目前主要使用的还是 `git checkout` 命令。 :br
::


### 合并分支 `git merge` / `git rebase`

需要将开发完成的分支合并到主分支上时，需要进行合并分支操作，首先介绍 `git merge` 命令。
:terminal{content="git merge [branch-name]"}

此命令会将 `[branch-name]` 分支合并到当前分支上，可以理解为分叉的树枝又合并在了一起。 :br
合并分支的过程中，*Git* 会自动合并两个节点的修改，然后生成一个新的提交对象，最后将当前分支指向新的提交对象。

![](/img/4/4/git-merge-branch.gif)

:sandbox{src="https://learngitbranching.js.org/?locale=zh_CN&NODEMO&command=git%20commit;git%20checkout%20-b%20bugFix%20C1;git%20commit;git%20merge%20main;git%20commit"}

---

另一种合并分支的方法是 *变基（rebase）* ，即将当前分支的提交历史全部移至另一分支，就像将树枝进行嫁接一样。 :br
:terminal{content="git rebase [branch-name]"}

此命令会将当前分支变基到 `[branch-name]` 分支上，然后将 `[branch-name]` 分支指向当前分支的最新提交对象。 :br
变基能使提交历史变得更加线性，以便人们更清晰的查看代码库的发展，但变基也有自身的缺点，特别是在远程仓库中使用时，可能会造成一些问题，因此在使用变基时需要谨慎。（这部分内容之后会讲解）

![](/img/4/4/git-rebase-branch.gif)

::alert{type="warning"}
合并分支时建议遵循该原则： :br
只对尚未推送或分享给别人的本地修改执行变基操作清理历史， 从不对已推送至别处的提交执行变基操作，这样，你才能享受到两种方式带来的便利。
[Pro Git Book](https://git-scm.com/book/zh/v2/Git-%E5%88%86%E6%94%AF-%E5%8F%98%E5%9F%BA)
::


## 远程仓库 

